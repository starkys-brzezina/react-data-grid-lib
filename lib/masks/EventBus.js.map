{"version":3,"file":"EventBus.js","sourceRoot":"","sources":["../../src/masks/EventBus.ts"],"names":[],"mappings":";;;;;;;;;;;;IAaA;QAAA;YACW,gBAAW,GAAG,IAAI,GAAG,EAAuC,CAAC;QAsBxE,CAAC;QApBC,4BAAS,GAAT,UAA+B,IAAO,EAAE,OAAoB;YAC1D,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;gBAC/B,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,EAAE,IAAI,GAAG,EAAE,CAAC,CAAC;aACvC;YAED,IAAM,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,CAAE,CAAC;YAC7C,QAAQ,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;YAEtB,OAAO;gBACL,QAAQ,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;YAC3B,CAAC,CAAC;QACJ,CAAC;QAED,2BAAQ,GAAR,UAA8B,IAAO;YAAE,cAAgC;iBAAhC,UAAgC,EAAhC,qBAAgC,EAAhC,IAAgC;gBAAhC,6BAAgC;;YACrE,IAAM,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;YAC5C,IAAI,QAAQ,EAAE;gBACZ,kDAAkD;gBAClD,QAAQ,CAAC,OAAO,CAAC,UAAA,OAAO,IAAI,OAAC,OAAsD,gCAAI,IAAI,IAA/D,CAAgE,CAAC,CAAC;aAC/F;QACH,CAAC;QACH,eAAC;IAAD,CAAC,AAvBD,IAuBC","sourcesContent":["import { Position } from '../common/types';\n\ninterface EventMap {\n  SELECT_CELL(cell: Position, openEditor?: boolean): void;\n  SELECT_START(selectedPosition: Position): void;\n  SELECT_UPDATE(cellPosition: Position, isFromKeyboard?: boolean, callback?: () => void): void;\n  SELECT_END(): void;\n  DRAG_ENTER(overRowIdx: number): void;\n  SCROLL_TO_COLUMN(idx: number): void;\n}\n\ntype EventName = keyof EventMap;\n\nexport default class EventBus {\n  readonly subscribers = new Map<EventName, Set<EventMap[EventName]>>();\n\n  subscribe<T extends EventName>(type: T, handler: EventMap[T]) {\n    if (!this.subscribers.has(type)) {\n      this.subscribers.set(type, new Set());\n    }\n\n    const handlers = this.subscribers.get(type)!;\n    handlers.add(handler);\n\n    return () => {\n      handlers.delete(handler);\n    };\n  }\n\n  dispatch<T extends EventName>(type: T, ...args: Parameters<EventMap[T]>) {\n    const handlers = this.subscribers.get(type);\n    if (handlers) {\n      // handler needed a type assertion to fix type bug\n      handlers.forEach(handler => (handler as (...args: Parameters<EventMap[T]>) => void)(...args));\n    }\n  }\n}\n"]}