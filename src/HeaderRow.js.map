{"version":3,"file":"HeaderRow.js","sourceRoot":"","sources":["HeaderRow.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport shallowEqual from 'shallowequal';\n\nimport HeaderCell from './HeaderCell';\nimport SortableHeaderCell from './common/cells/headerCells/SortableHeaderCell';\nimport FilterableHeaderCell from './common/cells/headerCells/FilterableHeaderCell';\nimport getScrollbarSize from './getScrollbarSize';\nimport { isFrozen } from './ColumnUtils';\nimport { HeaderRowType, HeaderCellType, DEFINE_SORT } from './common/enums';\nimport { CalculatedColumn, AddFilterEvent } from './common/types';\n\nexport interface HeaderRowProps {\n  width?: number;\n  height: number;\n  columns: CalculatedColumn[];\n  onSort(columnKey: string, direction: DEFINE_SORT): void;\n  onColumnResize(column: CalculatedColumn, width: number): void;\n  onColumnResizeEnd(column: CalculatedColumn, width: number): void;\n  style?: React.CSSProperties;\n  sortColumn?: string;\n  sortDirection?: DEFINE_SORT;\n  filterable?: boolean;\n  onFilterChange?(args: AddFilterEvent): void;\n  rowType: HeaderRowType;\n  draggableHeaderCell?: React.ComponentType<{ column: CalculatedColumn; onHeaderDrop(): void }>;\n  onHeaderDrop?(): void;\n  getValidFilterValues?(): any[];\n}\n\nexport default class HeaderRow extends React.Component<HeaderRowProps> {\n  static displayName = 'HeaderRow';\n\n  private readonly cells = new Map<string, HeaderCell>();\n\n  shouldComponentUpdate(nextProps: HeaderRowProps) {\n    return (\n      nextProps.width !== this.props.width\n      || nextProps.height !== this.props.height\n      || nextProps.columns !== this.props.columns\n      || !shallowEqual(nextProps.style, this.props.style)\n      || this.props.sortColumn !== nextProps.sortColumn\n      || this.props.sortDirection !== nextProps.sortDirection\n    );\n  }\n\n  getHeaderCellType(column: CalculatedColumn): HeaderCellType {\n    if (column.filterable && this.props.filterable) {\n      return HeaderCellType.FILTERABLE;\n    }\n\n    if (column.sortable && this.props.rowType !== HeaderRowType.FILTER) {\n      return HeaderCellType.SORTABLE;\n    }\n\n    return HeaderCellType.NONE;\n  }\n\n  getFilterableHeaderCell(column: CalculatedColumn) {\n    const FilterRenderer = column.filterRenderer || FilterableHeaderCell;\n    return (\n      <FilterRenderer\n        column={column}\n        onChange={this.props.onFilterChange}\n        getValidFilterValues={this.props.getValidFilterValues}\n      />\n    );\n  }\n\n  getSortableHeaderCell(column: CalculatedColumn) {\n    const sortDirection = this.props.sortColumn === column.key && this.props.sortDirection || DEFINE_SORT.NONE;\n    const sortDescendingFirst = column.sortDescendingFirst || false;\n    return (\n      <SortableHeaderCell\n        column={column}\n        rowType={this.props.rowType}\n        onSort={this.props.onSort}\n        sortDirection={sortDirection}\n        sortDescendingFirst={sortDescendingFirst}\n      />\n    );\n  }\n\n  getHeaderRenderer(column: CalculatedColumn) {\n    if (column.headerRenderer && !column.sortable && !this.props.filterable) {\n      return column.headerRenderer;\n    }\n    const headerCellType = this.getHeaderCellType(column);\n    switch (headerCellType) {\n      case HeaderCellType.SORTABLE:\n        return this.getSortableHeaderCell(column);\n      case HeaderCellType.FILTERABLE:\n        return this.getFilterableHeaderCell(column);\n      default:\n        return undefined;\n    }\n  }\n\n  getCells() {\n    const cells = [];\n    const frozenCells = [];\n    const { columns, rowType } = this.props;\n\n    for (const column of columns) {\n      const { key } = column;\n      const renderer = key === 'select-row' && rowType === HeaderRowType.FILTER ? <div /> : this.getHeaderRenderer(column);\n\n      const cell = (\n        <HeaderCell\n          key={key}\n          ref={node => node ? this.cells.set(key, node) : this.cells.delete(key)}\n          column={column}\n          rowType={rowType}\n          height={this.props.height}\n          renderer={renderer}\n          onResize={this.props.onColumnResize}\n          onResizeEnd={this.props.onColumnResizeEnd}\n          onHeaderDrop={this.props.onHeaderDrop}\n          draggableHeaderCell={this.props.draggableHeaderCell}\n        />\n      );\n\n      if (isFrozen(column)) {\n        frozenCells.push(cell);\n      } else {\n        cells.push(cell);\n      }\n    }\n\n    return cells.concat(frozenCells);\n  }\n\n  setScrollLeft(scrollLeft: number): void {\n    this.props.columns.forEach(column => {\n      const { key } = column;\n      if (!this.cells.has(key)) return;\n      const cell = this.cells.get(key)!;\n      if (isFrozen(column)) {\n        cell.setScrollLeft(scrollLeft);\n      } else {\n        cell.removeScroll();\n      }\n    });\n  }\n\n  render() {\n    const cellsStyle: React.CSSProperties = {\n      width: this.props.width ? this.props.width + getScrollbarSize() : '100%',\n      height: this.props.height\n    };\n\n    // FIXME: do we need 2 wrapping divs?\n    return (\n      <div\n        style={this.props.style}\n        className=\"react-grid-HeaderRow\"\n      >\n        <div style={cellsStyle}>\n          {this.getCells()}\n        </div>\n      </div>\n    );\n  }\n}\n"]}